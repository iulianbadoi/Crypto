clear all

[x,y] = meshgrid(-5:0.1:5);
F = 100 * (y - x.^2).^2 + (1 - x.^2).^2;

figure(2)
contour(x,y,F,20,'k')
hold on

X0 = [2;2];
x0 = X0(1);
y0 = X0(2);

F0 = 100 * (y - x.^2).^2 + (1 - x.^2).^2;
DF0 = [4*x0.*(101*x0.^2 - 100*y0 - 1); 200*(y0 - x0^2)];

H = [-400*(y0-x0.^2)+808*x0.^2-4*(1-x0.^2) -400*x0;  ...
     -400*x0  200];

hold on
for i = 1:9
    H = [ -400*(X0(2)-X0(1).^2)+808*X0(1).^2-4*(1-X0(1).^2) -400*X0(1);  ...
     -400*X0(1)  200];
    F0 = 100 * (X0(2) - X0(1)^2).^2 + (1 - X0(1)^2).^2;
    DF0 = [4*X0(1)*(101*X0(1)^2 - 100*X0(2) - 1); 200*(X0(2) - X0(1)^2)];
    X1 = X0 - inv(H)*DF0;
    plot([X0(1) X1(1)],[X0(2) X1(2)],'r',[X0(1) X1(1)],[X0(2) X1(2)],'ro')
    X0 = X1
    fun2(X0)
end

hold off